(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{1520:function(e,t,n){Promise.resolve().then(n.bind(n,2160))},2160:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var a=n(3827),l=n(7908),s=n(4090),i=n(5994),r=n(3251),c=n(3717),d=n(5342),o=n(4232),u=n(5198),m=n(8620).Buffer;function x(){let{isOpen:e,onOpen:t,onOpenChange:x}=(0,i.q)(),[p,h]=(0,s.useState)(!1),[f,j]=(0,s.useState)(!1),[b,g]=(0,s.useState)(""),[v,y]=(0,s.useState)([]),[N,w]=(0,s.useState)([]),k=(0,o.default)(()=>Promise.all([n.e(212),n.e(19),n.e(345),n.e(193)]).then(n.bind(n,8345)),{loadableGenerated:{webpack:()=>[8345]},ssr:!1}),C=(e,t)=>{let n=[{key:"item",label:"項次",value:t.item},{key:"name",label:"示範點名稱",value:t.name},{key:"map",label:"預覽",value:(0,a.jsx)(k,{data:_(t.name)})}];return g(t.name),"edit"===e&&n.splice(2,0,{key:"input",label:"GPX 匯入",value:(0,a.jsx)("input",{id:"editRouteFile",type:"file"},t.name)}),n},_=e=>[S.find(t=>t.route_name===e)],[S,E]=(0,s.useState)([]),O=()=>{l.Z.get("/api/route/getAll").then(e=>{E(e.data.data)})};(0,s.useEffect)(()=>{O()},[]);let A=()=>{let e=new FormData;document.getElementById("editRouteFile").files[0]&&e.append("file",document.getElementById("editRouteFile").files[0]),e.append("route_name",b||N.name),e.append("route_id",N.item);let t={headers:{"Content-Type":"multipart/form-data",Authorization:"Basic "+m.from("tycg_admin:TycGaDmIn2024").toString("base64")},params:{isNew:"false"}};l.Z.post("/api/route/save",e,t).then(e=>{alert("儲存成功"),O()})},F=(0,s.useMemo)(()=>S.map(e=>({item:e.id,name:e.route_name})),[S]),[Z,z]=(0,s.useState)(""),[P,B]=(0,s.useState)();return(0,a.jsxs)("main",{children:[(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 my-5 max-w-[1280px] mx-auto",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:"示範點 GPX 路線一覽表"}),(0,a.jsx)(r.A,{className:"ml-4",color:"secondary",onClick:()=>{t(),z("")},children:"新增路線"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 justify-center gap-4 w-full",children:[(0,a.jsx)("div",{children:(0,a.jsx)(d.Z,{headers:["項次","示範點名稱","操作"],columns:F,isAction:!0,view:e=>{h(!0),j(!1),y(C("view",e))},edit:e=>{h(!0),j(!0),y(C("edit",e)),w(e)}})}),p&&(0,a.jsxs)("div",{className:"border border-default-100 rounded-[14px] shadow-md bg-white p-4",children:[v.map((e,t)=>(0,a.jsxs)("div",{className:"".concat(t===v.length-1&&"rounded-bl-lg rounded-br-lg"," ").concat(0===t&&"border-t rounded-tl-lg rounded-tr-lg"," flex items-center justify-center border-b border-r border-l"),children:[(0,a.jsx)("div",{className:"".concat(0===t&&"rounded-tl-lg"," ").concat(v.length-1===t&&"rounded-bl-lg"," w-[140px] text-sm py-2 px-8 bg-default-100 ").concat("map"===e.key&&"self-baseline"),children:e.label}),"name"===e.key&&f?(0,a.jsx)("div",{className:"flex-1 px-2",children:(0,a.jsx)(c.Y,{type:"text",labelPlacement:"outside-left",placeholder:"請輸入名稱",value:b,size:"sm",onChange:e=>g(e.target.value)})}):(0,a.jsx)("div",{className:"flex-1 text-center px-8 ".concat("map"===e.key&&"!p-1"),children:e.value})]},e.key)),(0,a.jsxs)("div",{className:"flex items-center justify-center mt-4",children:[f&&(0,a.jsx)(r.A,{className:"ml-4",color:"secondary",size:"sm",onClick:()=>A(),children:"完成並儲存"}),(0,a.jsx)(r.A,{className:"ml-4",color:"default",size:"sm",onClick:()=>h(!1),children:"關閉"})]})]})]})]}),(0,a.jsx)(u.Z,{title:"新增路線",isOpen:e,onOpenChange:x,submit:()=>{let e=new FormData;e.append("file",P),e.append("route_name",Z);let t={headers:{"Content-Type":"multipart/form-data",Authorization:"Basic "+m.from("tycg_admin:TycGaDmIn2024").toString("base64")},params:{isNew:"true"}};l.Z.post("/api/route/save",e,t).then(e=>{alert("新增成功"),O()})},children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)(c.Y,{type:"text",label:"示範點名稱",labelPlacement:"outside-left",placeholder:"請輸入名稱",value:Z,onChange:e=>z(e.target.value)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm pr-3",children:"GPX 匯入"}),(0,a.jsx)("input",{className:"p-3 bg-default-100 rounded-xl",type:"file",onChange:e=>B(e.target.files[0])})]})]})})]})}},5198:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var a=n(3827);n(4090);var l=n(4178),s=n(1527),i=n(2561),r=n(7725),c=n(2646),d=n(2178);function o(e){let t=(0,d.F)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(l.R,{isOpen:e.isOpen,size:"mobile"===t?"xs":"2xl",placement:"mobile"===t?"top":"center",scrollBehavior:"inside",onOpenChange:e.onOpenChange,children:(0,a.jsx)(s.A,{children:t=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.k,{className:"flex flex-col gap-1",children:e.title}),(0,a.jsxs)(r.I,{children:[(0,a.jsx)("p",{dangerouslySetInnerHTML:{__html:e.content},className:"whitespace-pre-line"}),e.children]}),(0,a.jsx)(c.R,{})]})})},e.title)})}},5342:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var a=n(3827),l=n(6100),s=n(8467),i=n(5875),r=n(7697),c=n(6689),d=n(7915),o=n(1510),u=n(2470),m=n(1347);function x(e){let t=t=>{let{column:n}=t;return(0,a.jsxs)("div",{className:"relative flex items-center gap-2",children:[(0,a.jsx)(i.e,{content:"檢視",children:(0,a.jsx)("span",{className:"text-lg text-default-400 cursor-pointer active:opacity-50",onClick:()=>e.view(n),children:(0,a.jsx)(l.Z,{})})}),(0,a.jsx)(i.e,{content:"編輯",children:(0,a.jsx)("span",{className:"text-lg text-default-400 cursor-pointer active:opacity-50",onClick:()=>e.edit(n),children:(0,a.jsx)(s.Z,{})})})]})};return(0,a.jsxs)(r.b,{"aria-label":"Example static collection table",isStriped:!0,children:[(0,a.jsx)(c.J,{children:e.headers.map(e=>(0,a.jsx)(d.j,{className:"".concat(["第一場","第二場","第三場","數量合計"].includes(e)&&"text-center"," ").concat(["項次","示範點名稱"].includes(e)&&"text-sm"),children:e},e))}),e.isAction?(0,a.jsx)(o.y,{children:e.columns.map((e,n)=>(0,a.jsxs)(u.g,{children:[Object.keys(e).map(t=>(0,a.jsx)(m.X,{className:"".concat(["firstNumber","secondaryNumber","thirdNumber","totalNumber"].includes(t)&&"text-center"," ").concat(["name","item"].includes(t)&&"whitespace-nowrap"),children:e[t]},t)),(0,a.jsx)(m.X,{children:(0,a.jsx)(t,{column:e})},"action")]},n))}):(0,a.jsx)(o.y,{children:e.columns.map((e,t)=>(0,a.jsx)(u.g,{children:Object.keys(e).map(t=>(0,a.jsx)(m.X,{className:"".concat(["firstNumber","secondaryNumber","thirdNumber","totalNumber"].includes(t)&&"text-center"," ").concat(["name","item"].includes(t)&&"whitespace-nowrap"),children:e[t]},t))},t))})]})}},2178:function(e,t,n){"use strict";n.d(t,{F:function(){return l}});var a=n(4090);let l=()=>{let[e,t]=(0,a.useState)("");return(0,a.useEffect)(()=>{let e=()=>{t(window.innerWidth>=1024?"pc":window.innerWidth>=768?"tablet":"mobile")};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),e}}},function(e){e.O(0,[288,898,770,971,69,744],function(){return e(e.s=1520)}),_N_E=e.O()}]);